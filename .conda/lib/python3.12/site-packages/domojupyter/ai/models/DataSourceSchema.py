from typing import Optional, Any

from domojupyter.ai.models.Column import Column


class DataSourceSchema:
    def __init__(self, data_source_name: str, description: str, columns: list[Column]):
        self.dataSourceName = data_source_name
        self.description = description
        self.columns = columns

    @classmethod
    def from_optional_list(cls, optional_list: Optional[list[dict[str, Any]]], data_source_name: str = "",):
        columns = []
        description = ""
        if optional_list:
            for item in optional_list:
                column = Column(item['name'], item['type'])
                columns.append(column)
        return cls(data_source_name, description, columns)

    def to_json(self):
        return {
            "dataSourceName": self.dataSourceName,
            "description": self.description,
            "columns": [column.to_json() for column in self.columns]
        }
